<!--
    ==========================================================================
    Alerts Page
    --------------------------------------------------------------------------
    - Display live alerts as they are received
    - Does not contain historical data
    - Alerts may come from a service or a plugin
    ==========================================================================
-->

{% extends "base.html" %}

<!--
    ==========================================================================
    CSS Styles
    --------------------------------------------------------------------------
    mainoverride.css:
        - Override the default W3.CSS styles to make the page full width
        - This is necessary to ensure the table fits the screen width

    logtable.css:
        - Custom styles for the alert log table
        - Ensures the table is responsive and looks good on all devices
    ==========================================================================
-->
{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/mainoverride.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/logtable.css') }}">
{% endblock %}

{% block content %}

<!--
    ==========================================================================
    Scripts
    --------------------------------------------------------------------------
    autorefresh.js:
        - Adds a box to refresh the page automatically
    
    sorttable.js:
        - Enabled sorting of the table by clicking on the column headers
    ==========================================================================
-->
<script src="{{ url_for('static', filename='js/autorefresh.js') }}"></script>
<script src="{{ url_for('static', filename='js/sorttable.js') }}"></script>


<!--
    ==========================================================================
    Page Title and Refresh Button
    --------------------------------------------------------------------------
    - Title: "Live Alerts"
    - Refresh button: reloads the page to get the latest alerts
    - This is a separate section to align the refresh button with the title
    ==========================================================================
-->
<div class="w3-container w3-responsive w3-padding-16" style="padding-left:0; padding-right:0;">
    <div style="display: flex; align-items: center; justify-content: space-between;">
        <!-- Title -->
        <h1 style="margin: 0; text-align: left;">Live Alerts</h1>
        
        <!-- Refresh Button -->
        <div style="display: flex; align-items: center; gap: 12px;">
            <i class="fa fa-refresh"
            style="color:green; font-size:24px; cursor:pointer; text-align: right;"
            onclick="location.reload();"
            title="Refresh"></i>
            <label style="display: flex; align-items: center; font-size: 15px; margin-left: 12px;">
                <input type="checkbox" id="autoRefreshToggle" style="margin-right: 6px;">
                Auto-refresh
            </label>
        </div>    
    </div>
</div>

<!--
    ==========================================================================
    Table of alert entries
    --------------------------------------------------------------------------
    - Date and Time
    - Source (service or plugins name)
    - Alert message
    ==========================================================================
-->
<div class="w3-container w3-responsive w3-padding-16" style="width:90vw; max-width:1600px; margin:0 auto; overflow-x:auto;">
    <table class="w3-table w3-striped" style="table-layout: auto; width: 100%;">
        <thead>
            <tr>
                <th style="white-space:nowrap; cursor:pointer;" onclick="sortTable(0)">Time &#x25B2;&#x25BC;</th>
                <th style="white-space:nowrap; cursor:pointer;" onclick="sortTable(1)">Source &#x25B2;&#x25BC;</th>
                <th style="white-space:nowrap; cursor:pointer;" onclick="sortTable(2)">Type &#x25B2;&#x25BC;</th>
                <th style="cursor:pointer;" onclick="sortTable(3)">Message &#x25B2;&#x25BC;</th>
            </tr>
        </thead>
        <tbody>
        {% for alert in alerts %}
            <tr>
                <td style="white-space:nowrap;">{{ alert[0] }}</td>
                <td style="white-space:nowrap;">{{ alert[1] }}</td>
                <td style="white-space:nowrap;">{{ alert[2] }}</td>
                <td style="white-space:normal; overflow-wrap:break-word; word-break:break-all;">{{ alert[3] }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>

{% endblock %}